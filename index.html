<!DOCTYPE html>
<html lang="en">
<head>
    <title>WarsawJS Slides: Template</title>

    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge"/>
    <meta name="viewport" content="width=device-width"/>

    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet"/>

    <!-- Shower Theme -->
    <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css"/>
    <link rel="stylesheet" href="vendors/shower-warsawjs/styles/main.css"/>

    <!-- Prism.js -->
    <link rel="stylesheet" href="vendors/prism/prism.css"/>
    <link rel="stylesheet" href="modules/custom-prism.css"/>
</head>
<body class="shower list">
    <header class="caption">
        <h1>WarsawJS Slides: Template</h1>
        <p>We talk about JavaScript. Each month in Warsaw, Poland.</p>
    </header>

    <section class="slide front-page">
        <div class="logo">
            <!-- Logo WarsawJS -->
            <img src="vendors/shower-warsawjs/images/logo.svg" width="400">
        </div>
        <div class="details">
            <!-- 1. Avatar -->
            <img src="pictures/piotrleniec.jpeg" alt="Speaker"/>

            <!-- 2. Speaker -->
            <h2>Piotr Leniec</h2>

            <!-- 3. Presentation title -->
            <h2><strong>"Cookies, Web Storage i IndexedDB. Co, gdzie i jak?" [PL]</strong></h2>

            <!-- 4. Presentation date -->
            <h2>2018-04-11</h2>

            <!-- 5. Contact the speaker -->
            <h2><a href="https://www.linkedin.com/in/piotrleniec/">@piotrleniec</a></h2>
        </div>
    </section>

    <section class="slide compact">
        <h2>O mnie:</h2>
        <ul>
            <li>Vice President of Engineering w Spark Solutions</li>
            <ul>
                <li>Development - Ruby & JavaScript</li>
                <li>Rekrutacja</li>
                <li>Pomoc</li>
                <li>Zarządzanie projektami</li>
            </ul>
            <li><a href="https://leniec.com/" target="_blank" rel="noopener">leniec.com</a></li>
        </ul>
    </section>

    <section class="slide compact">
        <div style="text-align: center;">
            <img src="pictures/meme.png" alt="Expanding brain meme"/>
        </div>
    </section>

    <section class="slide compact">
        <div style="text-align: center;">
            <img src="pictures/cookies.jpg" alt="Cookies" />
        </div>
    </section>

    <section class="slide prism">
        <h2>JS Cookies API</h2>

        <pre style="font-size: 30px;" class="language-javascript line-numbers">
            <code>
                console.log(document.cookie) // "a=1; b=2; c=3"

                document.cookie = 'd=4'

                const expires = new Date(0).toString()
                document.cookie = 'b=;expires=' + expires
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>Problemy z ciastkami</h2>

        <ul>
            <li>Beznadziejne API</li>
            <li>Są wysyłane do serwera z każdym żądaniem</li>
            <li>Luki bezpieczeństwa (CSRF, XSS)</li>
            <li>Limity (4kb)</li>
        </ul>

        <img src="pictures/badcookie.png" width="150" />
    </section>

    <section class="slide compact">
        <h2>Kiedy używać ciastek</h2>

        <ul>
            <li>Jako tracker (lepsze od DOM Storage)</li>
            <li>Do przechowywania sesji użytkownika</li>
            <li>Do przechowywania różnych tokenów obsługiwanych przez backend</li>
        </ul>

        <img src="pictures/smilingcookie.png" />
    </section>

    <section class="slide compact">
        <h2>Kiedy nie używać ciastek</h2>

        <ul>
            <li>Do cachowania</li>
            <li>Do zapisywania stanu interfejsu</li>
            <li>W JS</li>
        </ul>

        <img src="pictures/nocookies.png" />
    </section>

    <section class="slide compact">
        <h2>DOM Storage</h2>

        <div style="text-align: center;">
            <img src="pictures/dom.jpg" height="400" />
        </div>
    </section>

    <section class="slide compact">
        <h2>Local Storage & Session Storage</h2>

        <ul>
            <li>Local Storage i Session Storage mają taki sam interfejs</li>
            <li>Local Storage przechowuje dane aż do usunięcia (nie ma terminu wygaśnięcia)</li>
            <li>Session Storage przechowuje dane przechowuje dane na czas trwania sesji (aż do zamknięcia taba)</li>
            <li>Każda przeglądarka ma swój limit (2MB, 5MB, 10MB)</li>
        </ul>
    </section>

    <section class="slide prism">
        <h2>DOM Storage API</h2>

        <pre style="font-size: 30px;" class="language-javascript line-numbers">
            <code>
                localStorage.setItem('a', 'b')
                localStorage.getItem('a') // 'b'

                localStorage.removeItem('a')
                localStorage.getItem('a') // null
            </code>
        </pre>
    </section>

    <section class="slide prism">
        <h2>DOM Storage API</h2>

        <pre style="font-size: 30px;" class="language-javascript line-numbers">
            <code>
                localStorage.a = 'b'
                localStorage.a // 'b'

                delete localStorage.a
                localStorage.a // undefined
            </code>
        </pre>
    </section>

    <section class="slide prism">
        <h2>DOM Storage API</h2>

        <pre style="font-size: 30px;" class="language-javascript line-numbers">
            <code>
                const object = { a: 1, b: 2, c: 3 }
                localStorage.setItem('object', object)

                localStorage.getItem('object') // "[object Object]"
            </code>
        </pre>
    </section>

    <section class="slide prism">
        <h2>DOM Storage API</h2>

        <pre style="font-size: 30px;" class="language-javascript line-numbers">
            <code>
                let object = { a: 1, b: 2, c: 3 }
                let objectString = JSON.stringify(object)
                localStorage.setItem('object', objectString)

                objectString = localStorage.getItem('object')
                JSON.parse(objectString) // { a: 1, b: 2, c: 3 }
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>Wsparcie DOM Storage</h2>

        <div style="text-align: center;">
            <img src="pictures/webstoragesupport.png" width="850" />
        </div>
    </section>

    <section class="slide compact">
        <h2>Co przechowywać w Storage</h2>

        <ul>
            <li>Stan interfejsu</li>
            <li>Wartości formularzy (logowanie się, GitHub)</li>
            <li>Tokeny używane przez JS (JWT, api tokens)</li>
        </ul>
    </section>

    <section class="slide compact">
        <h2>Czego nie przechowywać w DOM Storage</h2>

        <ul>
            <li>Kolekcje danych</li>
            <li>Rzeczy które są potrzebne w Web albo Service Workerze</li>
            <li>Bloby</li>
        </ul>
    </section>

    <section class="slide compact">
        <div style="text-align: center;">
            <img src="pictures/websql.png" />
        </div>
    </section>

    <section class="slide compact">
        <div style="text-align: center;">
            <img src="pictures/deprecated.png" />
        </div>
    </section>

    <section class="slide compact">
        <h2>WebSQL API</h2>

        <pre style="font-size: 20px;" class="language-javascript line-numbers">
            <code>
                const size = 5*1024*1024
                const db = window.openDatabase("name", "1.0", "description", size)

                db.executeSql('SELECT * FROM users', onSuccess, onError)

                db.transaction(tx => {
                    tx.executeSql('INSERT INTO users(name) VALUES(?)', ['Pete'])
                    tx.executeSql('INSERT INTO users(name) VALUES(?)', ['Paul'])
                }, onTransactionError, onTransactionSuccess)
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>IndexedDB</h2>

        <div style="text-align: center;">
            <img src="pictures/database.png" />
        </div>
    </section>

    <section class="slide compact">
        <h2>IndexedDB API</h2>

        <pre style="font-size: 20px;" class="language-javascript line-numbers">
            <code>
                const open = indexedDB.open('dbname', 3)
                open.onupgradeneeded = (event) => {
                    if (event.oldVersion < 1) {
                        // create v1 schema
                    }
                    if (event.oldVersion < 2) {
                        // upgrade v1 to v2 schema
                    }
                }
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>IndexedDB API</h2>

        <pre style="font-size: 20px;" class="language-javascript line-numbers">
            <code>
                const tx = db.transaction(['Users'], 'readwrite')
                const store = tx.objectStore('Users')

                store.put({ id: 1, name: 'John Doe' })
                store.put({ id: 2, name: 'Jane Doe' })
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>IndexedDB API</h2>

        <pre style="font-size: 20px;" class="language-javascript line-numbers">
            <code>
                const tx = db.transaction(['Users'], 'readonly')
                const store = tx.objectStore('Users')

                const getJohn = store.get(1)
                getJohn.onsuccess = () => {
                    getJohn.result // { id: 1, name: 'John Doe' }
                }
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>IndexedDB API</h2>

        <pre style="font-size: 20px;" class="language-javascript line-numbers">
            <code>
                const tx = db.transaction(['Users'], 'readwrite')
                const store = tx.objectStore('Users')

                store.delete(1)
            </code>
        </pre>
    </section>

    <section class="slide compact">
        <h2>Co przechowywać w IndexedDB</h2>

        <ul>
            <li>Kolekcje danych</li>
            <li>Dane binarne</li>
            <li>Odpowiedzi zapytań (offline first)</li>
        </ul>
    </section>

    <section class="slide compact">
        <h2>Czego nie przechowywać w IndexedDB</h2>

        <ul>
            <li>Proste dane</li>
            <li>Wszystko co moglibyśmy przechować w cookies lub DOM Storage</li>
        </ul>
    </section>

    <section class="slide compact">
        <h2>Pytania?</h2>

        <div style="text-align: center;">
            <img src="pictures/anyquestions.gif" />
        </div>
    </section>

    <div class="progress"></div>

    <footer class="badge">
        <a href="https://github.com/warsawjs/warsawjs-slides-template">Fork me on GitHub</a>
    </footer>

    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>
    <script src="vendors/shower-warsawjs/scripts/fullscreen.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="modules/custom-prism.js"></script>
</body>
</html>
